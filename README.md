# Tiles Survive! Guides - Веб-сайт с аналитикой

Одностраничный React сайт с полезными гайдами по игре Tiles Survive! с системой аналитики посещений по уникальным ссылкам.

## Особенности

- **Динамичный UI**: Современный интерфейс с анимациями, градиентами и интерактивными элементами
- **Аналитика посещений**: Сбор данных о переходах по ссылкам с ID (IP, страна, устройство, время)
- **Адаптивный дизайн**: Полностью адаптирован под мобильные устройства и десктоп
- **Фильтрация гайдов**: По категориям и сложности, поиск по названию
- **Тестовые данные**: 6 готовых гайдов с изображениями и описаниями

## Технологии

- React 19 + TypeScript
- Vite (сборка)
- Tailwind CSS 4 (стили)
- React Router DOM (маршрутизация)
- Axios (HTTP-запросы)
- ipinfo.io (определение геолокации по IP)

## Структура проекта

```
src/
├── components/           # React компоненты
│   ├── GuideCard.tsx    # Карточка гайда
│   ├── AnimatedBackground.tsx # Анимированный фон
│   └── ...
├── pages/               # Страницы
│   └── MainPage.tsx     # Главная страница
├── hooks/               # Пользовательские хуки
│   └── useAnalytics.ts  # Хук для аналитики
├── services/            # Сервисы
│   └── analytics.ts     # Логика сбора аналитики
└── ...
```

## Аналитика

Сайт собирает следующие данные при каждом посещении:

- **ID ссылки** (из URL: `/maf/{id}`)
- **IP адрес** и **геолокация** (страна, регион, город)
- **User Agent** (браузер, устройство)
- **Время посещения**
- **Разрешение экрана** и **язык**
- **Реферер** (откуда пришел пользователь)

Данные сохраняются в localStorage для демонстрации. В реальном проекте их нужно отправлять на ваш бэкенд.

### Настройка бэкенда для аналитики

1. Создайте эндпоинт для приема данных (например, `POST /api/analytics`)
2. Раскомментируйте код в `src/services/analytics.ts`:
   ```typescript
   // const ANALYTICS_ENDPOINT = import.meta.env.VITE_ANALYTICS_ENDPOINT;
   // await axios.post(ANALYTICS_ENDPOINT, analyticsData);
   ```
3. Укажите URL в `.env.local`:
   ```
   VITE_ANALYTICS_ENDPOINT=https://your-backend.com/api/analytics
   ```

### Настройка геолокации (IP и страна)

Для определения местоположения по IP используется сервис [ipinfo.io](https://ipinfo.io). Для увеличения лимитов запросов:

1. Зарегистрируйтесь на [ipinfo.io](https://ipinfo.io/signup) (бесплатный план: 50,000 запросов/месяц)
2. Получите токен API в личном кабинете
3. Добавьте токен в `.env.local`:
   ```
   VITE_IPINFO_TOKEN=your_token_here
   ```

Без токена сервис будет работать с ограничением (≈1000 запросов/день).

## Логирование

Система логирования перехватывает все вызовы console.log, console.error и другие в браузере и отправляет их на сервер для сохранения. Логи можно просмотреть по адресу `/logs`.

### Как это работает

1. Клиентский модуль `src/services/logger.ts` переопределяет методы console.*
2. Логи накапливаются в очереди и отправляются батчами на endpoint `/api/log`
3. Node.js сервер (папка `server/`) записывает логи в файл `server/logs/logs.txt`
4. По адресу `/logs` доступна веб-страница с просмотром логов
5. Система работает как в разработке, так и в production

### Настройка

Для разработки укажите в `.env.local`:
```
VITE_LOG_ENDPOINT=http://localhost:3001/api/log
```

Для production endpoint по умолчанию `/api/log` (относительный путь). Убедитесь, что Nginx настроен на проксирование запросов `/api/log` и `/logs` к Node.js серверу (порт 3001).

Подробнее в [DEPLOYMENT.md](DEPLOYMENT.md).

## Быстрый старт

### Установка зависимостей

```bash
npm install
```

### Запуск в режиме разработки

```bash
npm run dev
```

Откройте [http://localhost:5174](http://localhost:5174) в браузере.

### Сборка для production

```bash
npm run build
```

Собранные файлы появятся в папке `dist/`.

### Просмотр собранной версии

```bash
npm run preview
```

## Деплой

### Vercel (рекомендуется)

1. Зарегистрируйтесь на [vercel.com](https://vercel.com)
2. Установите Vercel CLI: `npm i -g vercel`
3. Войдите: `vercel login`
4. Деплой: `vercel --prod`

Или подключите GitHub репозиторий через веб-интерфейс Vercel.

### RUVDS (или любой другой хостинг)

1. Скопируйте файлы из `dist/` на ваш хостинг
2. Настройте сервер для обработки SPA (все запросы перенаправлять на `index.html`)

### Настройка маршрутизации

Сервер должен быть настроен на обработку SPA:
- Все пути, начинающиеся с `/maf/`, должны возвращать `index.html`
- Статические файлы (CSS, JS, изображения) должны обслуживаться как обычно

Пример для Nginx:
```nginx
location / {
    try_files $uri $uri/ /index.html;
}
```

## Использование ссылок с ID

Основная фича сайта — отслеживание переходов по уникальным ссылкам:

```
https://mydomain.ru/maf/123
https://mydomain.ru/maf/456
https://mydomain.ru/maf/789
```

Все ссылки ведут на одну и ту же страницу, но аналитика сохраняет:
- Какой ID был использован
- С какого IP пришел пользователь
- Из какой страны

Это позволяет раздавать разные ссылки разным людям/каналам и отслеживать эффективность.

## Тестовые данные

Сайт содержит 6 тестовых гайдов по категориям:
- Выживание
- Исследование
- Бой
- Крафтинг
- Экономика
- Достижения

Каждый гайд имеет:
- Изображение (локальные SVG файлы)
- Заголовок и описание
- Категорию и сложность
- Время чтения

Замените тестовые данные на реальные в `src/pages/MainPage.tsx`.

## Изображения

Все изображения хранятся локально в папке `public/images/`:

- `header-bg.svg` - фон хедера (игровая сцена)
- `footer-bg.svg` - фон футера (газон/трава)
- `guide1.svg` - `guide6.svg` - изображения для карточек гайдов

### Замена изображений на реальные скриншоты игры

1. **Для замены фоновых изображений**:
   - Замените файлы `header-bg.svg` и `footer-bg.svg` в папке `public/images/`
   - Поддерживаемые форматы: SVG, PNG, JPG, WebP
   - Рекомендуемый размер: минимум 1920px в ширину для фонов

2. **Для замены изображений гайдов**:
   - Замените файлы `guide1.svg` - `guide6.svg` в папке `public/images/`
   - Или обновите ссылки в массиве `mockGuides` в `src/pages/MainPage.tsx`:
   ```typescript
   imageUrl: '/images/ваше-изображение.jpg',
   ```
   - Рекомендуемый размер: 600×400px для оптимального отображения

3. **Использование внешних ссылок**:
   - Можно использовать URL из интернета, указав полный адрес
   - Для производительности рекомендуется локальное хранение

Текущие SVG изображения являются тестовыми и созданы программно. Замените их на реальные скриншоты из игры Tiles Survive!

## Лицензия

MIT

## Контакты

Проект создан для демонстрации возможностей React и аналитики посещений.

Для замены тестовых данных на реальные отредактируйте массив `mockGuides` в `MainPage.tsx`.